<% content_for :halo4, true %>
<% content_for :title, "Halo 4 - #{gamertag_validation(@service_record['Gamertag'])}'s Specializations" %>	
<% content_for :has_footer, true %>
<% content_for :halo4_active, 'specialization' %>
<% content_for :scripts do %>
<script>
</script>
<% end %>
<% content_for :template, 'halo4 halo4_specialization' %>

<%= render partial: 'halo4/partials/header', locals: { show_social: true } %>

<div class="container">
	<div class="row">
		<div class="col-md-3">
			<%= render partial: 'halo4/partials/sidebar' %>
		</div>

		<%
			active_specialization = nil
			complete_specializations = [ ]
			pending_specializations = [ ]

			@service_record['Specializations'].each do |specialization|
				if specialization['Completed']
					complete_specializations << specialization
				elsif specialization['IsCurrent']
					active_specialization = specialization
				else
					pending_specializations << specialization
				end
			end
		%>

		<div class="col-md-9">
			<div class="bs-branch-section specialization">
				<%= render partial: 'partials/flash', locals: { flash: flash } %>
				<% if (active_specialization != nil) %>
					<div class="row">
						<div class="col-md-12 active-specialization">
							<h2>
								Active Specialization;
							</h2>
							<hr />
							<div class="row">
								<div class="col-md-1"></div>
								<div class="col-md-3 specialization-icon visible-md visible-lg" style="background-image: url(<%= get_raw_asset_url(active_specialization['ImageUrl'], 'large') %>);"></div>
								<div class="col-md-8">
									<span class="title">
										<%= active_specialization['Name'] %> (<%= active_specialization['LevelName'] %>)
									</span>
									<br />
									<span class="description">
										<%= active_specialization['Description'] %>
									</span>
									<div class="level-progression">
										<span class="level">
											Current Level:
											<strong>
												<%= active_specialization['Level'] %>
											</strong>
										</span>
										<div class="progress">
											<div class="progress-bar"  role="progressbar" aria-valuenow="<%= active_specialization['PercentComplete'] * 100 %>" aria-valuemin="0" aria-valuemax="100" style="width: <%= active_specialization['PercentComplete'] * 100 %>%">
												<span class="sr-only"><%= active_specialization['PercentComplete'] * 100 %>% Complete</span>
												<span class="progress-bar-indicator"><%= active_specialization['PercentComplete'] * 100 %>% Complete</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				<% end %>
				<div class="row other-shit">
					<div class="col-md-12">
						<ul class="nav nav-tabs" style="margin-bottom: 15px;">
							<li class="active"><a href="#pending" data-toggle="tab">Pending Specializations</a></li>
							<li><a href="#completed" data-toggle="tab">Completed Specializations</a></li>
						</ul>
						<div class="tab-content">
							<div class="col-md-12 tab-pane fade active in" id="pending">
								<% if (pending_specializations.length == 0) %>
									<div class="row">
										<div class="col-md-12">
											<h2>All Specializations Completed!</h2>
										</div>
									</div>
								<% else %>
									<% pending_specializations.each do |specialization| %>
										<div class="row">
											<div class="col-md-1"></div>
											<div class="col-md-3 specialization-icon visible-md visible-lg" style="background-image: url(<%= get_raw_asset_url(specialization['ImageUrl'], 'large') %>);"></div>
											<div class="col-md-8">
												<span class="title">
													<%= specialization['Name'] %>
												</span>
												<br />
												<span class="description">
													<%= specialization['Description'] %>
												</span>
											</div>
										</div>
										<hr class="" />
									<% end %>
								<% end %>
							</div>
							<div class="col-md-12 tab-pane fade" id="completed">
								<% if (complete_specializations.length == 0) %>
									<div class="row">
										<div class="col-md-12">
											<h2>You haven't completed any specializations :(</h2>
										</div>
									</div>
								<% else %>
									<% complete_specializations.each do |specialization| %>
										<div class="row">
											<div class="col-md-1"></div>
											<div class="col-md-3 specialization-icon visible-md visible-lg" style="background-image: url(<%= get_raw_asset_url(specialization['ImageUrl'], 'large') %>);"></div>
											<div class="col-md-8">
												<span class="title">
													<%= specialization['Name'] %>
												</span>
												<br />
												<span class="description">
													<%= specialization['Description'] %>
												</span>
											</div>
										</div>
										<hr class="" />
									<% end %>
								<% end %>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
