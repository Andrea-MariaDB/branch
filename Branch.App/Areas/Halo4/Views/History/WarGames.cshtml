@using Branch.App.Areas.Halo4.Models
@using Branch.App.Helpers.Razor
@using Branch.App.Helpers.Razor.Halo4
@using Branch.Extenders
@using Branch.Models.Services.Halo4._343.DataModels
@using Enums = Branch.App.Areas.Halo4.Models.Enums
@model HistoryData<GameHistoryModel.WarGames>
@{
	ViewBag.Title = string.Format("{0}'s Halo 4 War Games History", BranchHelpers.CheckGamertagPrivacy(@Model.ServiceRecord.Gamertag));
	Layout = "~/Areas/Halo4/Views/Shared/_Layout.cshtml";
	ViewBag.Template = "halo4_game_history";
	ViewBag.CurrentH4Page = Enums.Pages.GameHistory;
	ViewBag.CurrentHistoryMode = Model.GameMode;

	var serviceRecord = Model.ServiceRecord;
	var gameHistory = Model.GameHistory;
}

<div class="col-md-9">
	<div class="bs-branch-section overview">
		<div class="page-header">
			<h1>War Games History</h1>
		</div>

		<table class="table game-history">
			<thead>
				<tr>
					<th>Game Type</th>
					<th>Standing</th>
					<th>Date</th>
					<th>Score</th>
					<th>Map</th>
					<th>Playlist</th>
				</tr>
			</thead>

			<tbody>
				@foreach (var game in gameHistory.Games)
				{
					<tr class="history-row">
						<td>
							@Html.RouteLink(game.VariantName, "Halo4_Game",
								new { gamertag = BranchHelpers.CheckGamertagPrivacy(serviceRecord.Gamertag), id = game.Id })
						</td>

						<td>
							@GeneralHelpers.GetGameVictoryStatus(game.Result, game.Completed).Item2
							@if (game.Completed)
							{
								@:(@game.Standing.Ordinal())
							}

						</td>
						<td>
							@BranchHelpers.MakeDateTimeFriendly(game.EndDateUtc, "d")
						</td>
						<td>
							@game.PersonalScore
						</td>
						<td>
							@game.MapVariantName
						</td>
						<td>
							@Html.RouteLink(game.PlaylistName, "Halo4_CsrDetails",
								new
								{
									gamertag = BranchHelpers.CheckGamertagPrivacy(serviceRecord.Gamertag),
									id = game.PlaylistId,
									slug = game.PlaylistName.ToSlug()
								})
						</td>
					</tr>
				}
			</tbody>

		</table>

		<ul class="pager">
			<li class="previous
				<%= 'disabled' if page == 0 %> ">
				<%= link_to('← Newer', halo4_gamehistory_path( sub_view: sub_view, page: update_pagination(page, 'older'))) %>
			</li>
			<li class="next
				<%= 'disabled' if is_last_page %>">
				<%= link_to('Older →', halo4_gamehistory_path( sub_view: sub_view, page: update_pagination(page, 'newer'))) %>
			</li>
		</ul>
	</div>
</div>
